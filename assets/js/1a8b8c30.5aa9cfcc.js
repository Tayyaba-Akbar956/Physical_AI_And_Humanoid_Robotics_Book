"use strict";(globalThis.webpackChunkphysical_ai_robotics_book=globalThis.webpackChunkphysical_ai_robotics_book||[]).push([[509],{117:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>p,frontMatter:()=>t,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"module-02-ros2-middleware/part-01-communication/python-rclpy","title":"Python and rclpy","description":"This chapter focuses on implementing ROS 2 nodes using Python and the rclpy client library. Python is one of the most popular languages for robotics development, and rclpy provides the Python interface to the ROS 2 client library implementation.","source":"@site/docs/module-02-ros2-middleware/part-01-communication/03-python-rclpy.md","sourceDirName":"module-02-ros2-middleware/part-01-communication","slug":"/module-02-ros2-middleware/part-01-communication/python-rclpy","permalink":"/docs/module-02-ros2-middleware/part-01-communication/python-rclpy","draft":false,"unlisted":false,"editUrl":"https://github.com/Tayyaba-Akbar956/Physical_AI_And_Humanoid_Robotics_Book/tree/main/docs/module-02-ros2-middleware/part-01-communication/03-python-rclpy.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"Python and rclpy"},"sidebar":"tutorialSidebar","previous":{"title":"Nodes, Topics, and Services","permalink":"/docs/module-02-ros2-middleware/part-01-communication/nodes-topics-services"},"next":{"title":"URDF Format","permalink":"/docs/module-02-ros2-middleware/part-02-robot-description/urdf-format"}}');var i=s(4848),a=s(8453);const t={sidebar_position:3,title:"Python and rclpy"},l="Python and rclpy",o={},c=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Introduction: Python in Robotics",id:"introduction-python-in-robotics",level:2},{value:"Core Concepts",id:"core-concepts",level:2},{value:"rclpy Architecture",id:"rclpy-architecture",level:3},{value:"Node Creation and Lifecycle",id:"node-creation-and-lifecycle",level:3},{value:"Threading and Concurrency",id:"threading-and-concurrency",level:3},{value:"Practical Implementation",id:"practical-implementation",level:2},{value:"Setting Up Python Environment",id:"setting-up-python-environment",level:3},{value:"Basic Node Structure",id:"basic-node-structure",level:3},{value:"Implementing Publishers",id:"implementing-publishers",level:3},{value:"Implementing Subscribers",id:"implementing-subscribers",level:3},{value:"Implementing Services",id:"implementing-services",level:3},{value:"Multi-threaded Execution",id:"multi-threaded-execution",level:3},{value:"Parameters in rclpy",id:"parameters-in-rclpy",level:3},{value:"Complete Practical Example: TurtleBot Navigation System",id:"complete-practical-example-turtlebot-navigation-system",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Error Handling and Logging",id:"error-handling-and-logging",level:3},{value:"Resource Management",id:"resource-management",level:3},{value:"Interactive Exercises",id:"interactive-exercises",level:2},{value:"Exercise 1: Time Publisher and Subscriber",id:"exercise-1-time-publisher-and-subscriber",level:3},{value:"Exercise 2: Distance Calculation Service",id:"exercise-2-distance-calculation-service",level:3},{value:"Exercise 3: Configurable Robot Controller",id:"exercise-3-configurable-robot-controller",level:3},{value:"Exercise 4: Sensor Processing Node",id:"exercise-4-sensor-processing-node",level:3},{value:"Exercise 5: Multi-Node Communication System",id:"exercise-5-multi-node-communication-system",level:3},{value:"Exercise 6: Parameter-Based Behavior Control",id:"exercise-6-parameter-based-behavior-control",level:3},{value:"Exercise 7: System Integration Challenge",id:"exercise-7-system-integration-challenge",level:3},{value:"Tools for Testing and Verification",id:"tools-for-testing-and-verification",level:3},{value:"Hands-on Package Creation Exercises",id:"hands-on-package-creation-exercises",level:2},{value:"Exercise A: Creating Your First ROS 2 Package",id:"exercise-a-creating-your-first-ros-2-package",level:3},{value:"Exercise B: Creating a Publisher-Subscriber Package",id:"exercise-b-creating-a-publisher-subscriber-package",level:3},{value:"Exercise C: Creating a Service Server and Client Package",id:"exercise-c-creating-a-service-server-and-client-package",level:3},{value:"Exercise D: Using Parameters in Your Package",id:"exercise-d-using-parameters-in-your-package",level:3},{value:"Exercise E: Creating a Launch File for Multiple Nodes",id:"exercise-e-creating-a-launch-file-for-multiple-nodes",level:3},{value:"Exercise F: Creating Custom Message Types",id:"exercise-f-creating-custom-message-types",level:3},{value:"Troubleshooting Common ROS 2 Issues",id:"troubleshooting-common-ros-2-issues",level:2},{value:"Common Issues and Solutions",id:"common-issues-and-solutions",level:3},{value:"1. Module Import Errors",id:"1-module-import-errors",level:4},{value:"2. Node Connection Issues",id:"2-node-connection-issues",level:4},{value:"3. Topic/Service Names Conflicts",id:"3-topicservice-names-conflicts",level:4},{value:"4. Parameter Issues",id:"4-parameter-issues",level:4},{value:"5. Resource Management Problems",id:"5-resource-management-problems",level:4},{value:"6. Threading and Concurrency Issues",id:"6-threading-and-concurrency-issues",level:4},{value:"7. Performance Issues",id:"7-performance-issues",level:4},{value:"8. Package and Build Issues",id:"8-package-and-build-issues",level:4},{value:"Debugging Techniques",id:"debugging-techniques",level:3},{value:"1. Verbose Logging",id:"1-verbose-logging",level:4},{value:"2. Using ROS 2 Command-line Tools",id:"2-using-ros-2-command-line-tools",level:4},{value:"3. Runtime Parameter Adjustment",id:"3-runtime-parameter-adjustment",level:4},{value:"4. Visualization Tools",id:"4-visualization-tools",level:4},{value:"Best Practices for Avoiding Common Issues",id:"best-practices-for-avoiding-common-issues",level:3},{value:"Key Takeaways",id:"key-takeaways",level:2},{value:"Further Reading",id:"further-reading",level:2},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"python-and-rclpy",children:"Python and rclpy"})}),"\n",(0,i.jsx)(n.p,{children:"This chapter focuses on implementing ROS 2 nodes using Python and the rclpy client library. Python is one of the most popular languages for robotics development, and rclpy provides the Python interface to the ROS 2 client library implementation."}),"\n",(0,i.jsx)(n.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Set up Python development environment for ROS 2"}),"\n",(0,i.jsx)(n.li,{children:"Create nodes using rclpy with proper lifecycle management"}),"\n",(0,i.jsx)(n.li,{children:"Implement publishers, subscribers, services, and clients"}),"\n",(0,i.jsx)(n.li,{children:"Apply Python-specific patterns and best practices in ROS 2"}),"\n",(0,i.jsx)(n.li,{children:"Debug and test Python ROS 2 nodes effectively"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"introduction-python-in-robotics",children:"Introduction: Python in Robotics"}),"\n",(0,i.jsx)(n.p,{children:"Python has become one of the dominant languages in robotics and AI development for several reasons:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Rapid prototyping"}),": Python's simplicity allows quick development and testing of robotic algorithms"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Rich ecosystem"}),": Extensive libraries for computer vision, machine learning, and scientific computing"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Community support"}),": Large robotics and AI communities with extensive resources"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Integration"}),": Easy integration with other tools and systems"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"rclpy"})," package provides the Python client library for ROS 2, allowing Python developers to create ROS 2 nodes, publishers, subscribers, services, and clients."]}),"\n",(0,i.jsx)(n.h2,{id:"core-concepts",children:"Core Concepts"}),"\n",(0,i.jsx)(n.h3,{id:"rclpy-architecture",children:"rclpy Architecture"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"rclpy"})," library provides a Python interface to the underlying ROS 2 client library implementation:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Nodes"}),": The basic execution unit in ROS 2"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Publishers"}),": Send messages to topics"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Subscribers"}),": Receive messages from topics"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Services"}),": Provide synchronous request-response functionality"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Clients"}),": Make synchronous requests to services"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Actions"}),": Handle long-running goal-oriented tasks"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Timers"}),": Execute callbacks at regular intervals"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Parameters"}),": Store and manage node configuration"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"node-creation-and-lifecycle",children:"Node Creation and Lifecycle"}),"\n",(0,i.jsxs)(n.p,{children:["Every ROS 2 Python node inherits from the ",(0,i.jsx)(n.code,{children:"rclpy.node.Node"})," class:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"The node constructor takes the node name and optional parameters"}),"\n",(0,i.jsx)(n.li,{children:"Nodes manage their own resources and must be properly destroyed"}),"\n",(0,i.jsx)(n.li,{children:"The rclpy execution model handles callback scheduling and message processing"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"threading-and-concurrency",children:"Threading and Concurrency"}),"\n",(0,i.jsx)(n.p,{children:"ROS 2 Python nodes can use different execution models:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Single-threaded executor"}),": Processes callbacks sequentially"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Multi-threaded executor"}),": Processes callbacks in parallel using a thread pool"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Custom executors"}),": For specialized concurrency patterns"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"practical-implementation",children:"Practical Implementation"}),"\n",(0,i.jsx)(n.h3,{id:"setting-up-python-environment",children:"Setting Up Python Environment"}),"\n",(0,i.jsx)(n.p,{children:"Before creating ROS 2 Python nodes, you need to set up your environment:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Source the ROS 2 environment:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"source /opt/ros/humble/setup.bash  # Replace with your ROS 2 distribution\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsx)(n.li,{children:"Create a Python package with proper dependencies:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"mkdir ~/ros2_workspace/src/my_robot_package\ncd ~/ros2_workspace/src/my_robot_package\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsx)(n.li,{children:"Create setup.py and package.xml files with required dependencies"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"basic-node-structure",children:"Basic Node Structure"}),"\n",(0,i.jsx)(n.p,{children:"Here's the basic structure of a ROS 2 Python node:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\nimport rclpy\nfrom rclpy.node import Node\n\nclass MyRobotNode(Node):\n    def __init__(self):\n        # Initialize the node with a name\n        super().__init__('my_robot_node')\n        \n        # Log a message\n        self.get_logger().info('MyRobotNode initialized')\n\ndef main():\n    # Initialize rclpy\n    rclpy.init()\n    \n    # Create node instance\n    node = MyRobotNode()\n    \n    try:\n        # Spin the node (process callbacks)\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        # Clean up\n        node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"implementing-publishers",children:"Implementing Publishers"}),"\n",(0,i.jsx)(n.p,{children:"Here's how to create and use publishers in rclpy:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String, Int32\nfrom geometry_msgs.msg import Twist\n\nclass SensorPublisher(Node):\n    def __init__(self):\n        super().__init__('sensor_publisher')\n        \n        # Create multiple publishers\n        self.string_publisher = self.create_publisher(\n            String,\n            'status',\n            10  # QoS queue size\n        )\n        \n        self.count_publisher = self.create_publisher(\n            Int32,\n            'counter',\n            10\n        )\n        \n        self.cmd_vel_publisher = self.create_publisher(\n            Twist,\n            'cmd_vel',\n            10\n        )\n        \n        # Create a timer to publish messages at regular intervals\n        timer_period = 0.5  # seconds\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n        self.i = 0\n        \n    def timer_callback(self):\n        # Publish string message\n        msg = String()\n        msg.data = f'Hello World: {self.i}'\n        self.string_publisher.publish(msg)\n        \n        # Publish counter message\n        count_msg = Int32()\n        count_msg.data = self.i\n        self.count_publisher.publish(count_msg)\n        \n        # Publish velocity command\n        vel_msg = Twist()\n        vel_msg.linear.x = 0.1  # Move forward slowly\n        self.cmd_vel_publisher.publish(vel_msg)\n        \n        self.get_logger().info(f'Publishing: \"{msg.data}\", counter: {count_msg.data}')\n        self.i += 1\n\ndef main():\n    rclpy.init()\n    node = SensorPublisher()\n    \n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"implementing-subscribers",children:"Implementing Subscribers"}),"\n",(0,i.jsx)(n.p,{children:"Here's how to create and use subscribers in rclpy:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\nfrom sensor_msgs.msg import LaserScan\nimport math\n\nclass DataProcessor(Node):\n    def __init__(self):\n        super().__init__('data_processor')\n        \n        # Create subscribers\n        self.string_subscription = self.create_subscription(\n            String,\n            'status',\n            self.string_callback,\n            10\n        )\n        \n        self.scan_subscription = self.create_subscription(\n            LaserScan,\n            'scan',\n            self.scan_callback,\n            10\n        )\n        \n        # Prevent unused variable warning\n        self.string_subscription\n        self.scan_subscription\n        \n        # Initialize data storage\n        self.last_status = None\n        self.obstacle_distances = []\n        \n    def string_callback(self, msg):\n        self.last_status = msg.data\n        self.get_logger().info(f'Received status: {msg.data}')\n        \n    def scan_callback(self, msg):\n        # Process laser scan data\n        min_distance = float('inf')\n        for range_val in msg.ranges:\n            if not math.isnan(range_val) and range_val < min_distance:\n                min_distance = range_val\n                \n        if min_distance < 1.0:  # Obstacle within 1 meter\n            self.get_logger().warn(f'Obstacle detected at {min_distance:.2f}m')\n        else:\n            self.get_logger().info(f'Clear path, nearest obstacle at {min_distance:.2f}m')\n\ndef main():\n    rclpy.init()\n    node = DataProcessor()\n    \n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"implementing-services",children:"Implementing Services"}),"\n",(0,i.jsx)(n.p,{children:"Here's how to create and use services in rclpy:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom example_interfaces.srv import AddTwoInts\n\nclass CalculatorService(Node):\n    def __init__(self):\n        super().__init__('calculator_service')\n        \n        # Create service server\n        self.srv = self.create_service(\n            AddTwoInts,\n            'add_two_ints',\n            self.add_callback\n        )\n        \n    def add_callback(self, request, response):\n        response.sum = request.a + request.b\n        self.get_logger().info(f'{request.a} + {request.b} = {response.sum}')\n        return response\n\ndef main():\n    rclpy.init()\n    node = CalculatorService()\n    \n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"multi-threaded-execution",children:"Multi-threaded Execution"}),"\n",(0,i.jsx)(n.p,{children:"For nodes that need to handle multiple callbacks concurrently:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom rclpy.executors import MultiThreadedExecutor\nfrom std_msgs.msg import String\nimport time\n\nclass ThreadingExample(Node):\n    def __init__(self):\n        super().__init__('threading_example')\n        \n        # Publisher\n        self.publisher = self.create_publisher(String, 'thread_status', 10)\n        \n        # Timers with different periods\n        self.create_timer(1.0, self.slow_timer_callback)\n        self.create_timer(0.1, self.fast_timer_callback)\n        \n    def slow_timer_callback(self):\n        self.get_logger().info('Slow timer executing...')\n        # Simulate slow operation\n        time.sleep(0.5)  # This would block single-threaded executor\n        msg = String()\n        msg.data = 'Slow operation completed'\n        self.publisher.publish(msg)\n        \n    def fast_timer_callback(self):\n        self.get_logger().info('Fast timer executing...')\n        msg = String()\n        msg.data = 'Fast update'\n        self.publisher.publish(msg)\n\ndef main():\n    rclpy.init()\n    node = ThreadingExample()\n    \n    # Use multi-threaded executor to handle blocking operations\n    executor = MultiThreadedExecutor()\n    executor.add_node(node)\n    \n    try:\n        executor.spin()\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"parameters-in-rclpy",children:"Parameters in rclpy"}),"\n",(0,i.jsx)(n.p,{children:"ROS 2 nodes can use parameters for configuration:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom rclpy.parameter import Parameter\nfrom rcl_interfaces.msg import SetParametersResult\n\nclass ParameterExample(Node):\n    def __init__(self):\n        super().__init__('parameter_example')\n\n        # Declare parameters with default values\n        self.declare_parameter('robot_name', 'default_robot')\n        self.declare_parameter('max_velocity', 1.0)\n        self.declare_parameter('safety_distance', 0.5)\n\n        # Get parameter values\n        self.robot_name = self.get_parameter('robot_name').value\n        self.max_velocity = self.get_parameter('max_velocity').value\n        self.safety_distance = self.get_parameter('safety_distance').value\n\n        self.get_logger().info(\n            f'Robot: {self.robot_name}, Max vel: {self.max_velocity}, '\n            f'Safety dist: {self.safety_distance}'\n        )\n\n        # Create callback for parameter changes\n        self.add_on_set_parameters_callback(self.parameter_callback)\n\n    def parameter_callback(self, params):\n        for param in params:\n            if param.name == 'max_velocity' and param.type_ == Parameter.Type.DOUBLE:\n                if 0.0 < param.value <= 5.0:  # Validate parameter\n                    self.max_velocity = param.value\n                    self.get_logger().info(f'Max velocity updated to {param.value}')\n                    return SetParametersResult(successful=True)\n                else:\n                    self.get_logger().error(f'Invalid max_velocity: {param.value}')\n                    return SetParametersResult(successful=False)\n        return SetParametersResult(successful=True)\n\ndef main():\n    rclpy.init()\n    node = ParameterExample()\n\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"complete-practical-example-turtlebot-navigation-system",children:"Complete Practical Example: TurtleBot Navigation System"}),"\n",(0,i.jsx)(n.p,{children:"Here's a comprehensive example that combines multiple ROS 2 concepts to create a simple navigation system for a TurtleBot-like robot:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'#!/usr/bin/env python3\nimport rclpy\nfrom rclpy.node import Node\nfrom geometry_msgs.msg import Twist, Point\nfrom sensor_msgs.msg import LaserScan\nfrom nav_msgs.msg import Odometry\nfrom std_msgs.msg import String\nfrom rclpy.qos import QoSProfile\nfrom rclpy.qos import qos_profile_sensor_data\nimport math\nimport time\n\nclass TurtleBotNavigator(Node):\n    def __init__(self):\n        super().__init__(\'turtlebot_navigator\')\n\n        # Declare parameters\n        self.declare_parameter(\'linear_speed\', 0.2)  # m/s\n        self.declare_parameter(\'angular_speed\', 0.5)  # rad/s\n        self.declare_parameter(\'safety_distance\', 0.5)  # meters\n        self.declare_parameter(\'target_distance\', 2.0)  # meters\n\n        # Get parameters\n        self.linear_speed = self.get_parameter(\'linear_speed\').value\n        self.angular_speed = self.get_parameter(\'angular_speed\').value\n        self.safety_distance = self.get_parameter(\'safety_distance\').value\n        self.target_distance = self.get_parameter(\'target_distance\').value\n\n        # Create publishers\n        self.cmd_vel_publisher = self.create_publisher(\n            Twist,\n            \'/cmd_vel\',\n            10\n        )\n\n        # Create subscribers\n        self.scan_subscriber = self.create_subscription(\n            LaserScan,\n            \'/scan\',\n            self.scan_callback,\n            qos_profile=qos_profile_sensor_data\n        )\n\n        self.odom_subscriber = self.create_subscription(\n            Odometry,\n            \'/odom\',\n            self.odom_callback,\n            10\n        )\n\n        self.status_publisher = self.create_publisher(\n            String,\n            \'/navigation_status\',\n            10\n        )\n\n        # Navigation state\n        self.laser_ranges = []\n        self.position = Point()\n        self.orientation = 0.0\n        self.nav_state = "idle"  # idle, moving, avoiding, reached\n        self.start_time = time.time()\n        self.distance_traveled = 0.0\n        self.last_position = Point()\n\n        # Timer for navigation logic\n        self.nav_timer = self.create_timer(0.1, self.navigation_loop)\n\n        self.get_logger().info(\'TurtleBot Navigator initialized\')\n\n    def scan_callback(self, msg):\n        """Process laser scan data to detect obstacles"""\n        self.laser_ranges = msg.ranges\n\n        # Find the minimum distance in front of the robot\n        front_scan = self.laser_ranges[len(self.laser_ranges)//2 - 90:len(self.laser_ranges)//2 + 90]\n        if front_scan:\n            self.min_front_distance = min([r for r in front_scan if not math.isnan(r)], default=float(\'inf\'))\n        else:\n            self.min_front_distance = float(\'inf\')\n\n    def odom_callback(self, msg):\n        """Process odometry data to track position"""\n        self.position.x = msg.pose.pose.position.x\n        self.position.y = msg.pose.pose.position.y\n        self.position.z = msg.pose.pose.position.z\n\n        # Simple conversion of quaternion to yaw (for 2D navigation)\n        # In a real system, you might want to use tf2 for this\n        orientation_q = msg.pose.pose.orientation\n        siny_cosp = 2 * (orientation_q.w * orientation_q.z + orientation_q.x * orientation_q.y)\n        cosy_cosp = 1 - 2 * (orientation_q.y * orientation_q.y + orientation_q.z * orientation_q.z)\n        self.orientation = math.atan2(siny_cosp, cosy_cosp)\n\n        # Calculate distance traveled since last check\n        if self.last_position.x != 0 or self.last_position.y != 0:\n            self.distance_traveled += math.sqrt(\n                (self.position.x - self.last_position.x)**2 +\n                (self.position.y - self.last_position.y)**2\n            )\n\n        self.last_position.x = self.position.x\n        self.last_position.y = self.position.y\n\n    def navigation_loop(self):\n        """Main navigation loop"""\n        cmd_msg = Twist()\n\n        if self.nav_state == "idle":\n            # Start navigation\n            self.nav_state = "moving"\n            self.start_time = time.time()\n            self.distance_traveled = 0.0\n            self.last_position = Point()\n            cmd_msg.linear.x = self.linear_speed\n            cmd_msg.angular.z = 0.0\n\n        elif self.nav_state == "moving":\n            # Check if obstacle is detected\n            if self.min_front_distance <= self.safety_distance:\n                self.nav_state = "avoiding"\n                self.get_logger().info(\'Obstacle detected, starting avoidance\')\n            # Check if target distance is reached\n            elif self.distance_traveled >= self.target_distance:\n                self.nav_state = "reached"\n                self.get_logger().info(\'Target distance reached\')\n            else:\n                # Continue moving forward\n                cmd_msg.linear.x = self.linear_speed\n                cmd_msg.angular.z = 0.0\n\n        elif self.nav_state == "avoiding":\n            # Simple obstacle avoidance - turn right\n            cmd_msg.linear.x = 0.0\n            cmd_msg.angular.z = -self.angular_speed\n\n            # Resume forward motion if obstacle is cleared\n            if self.min_front_distance > self.safety_distance * 1.5:\n                self.nav_state = "moving"\n                cmd_msg.linear.x = self.linear_speed\n                cmd_msg.angular.z = 0.0\n\n        elif self.nav_state == "reached":\n            # Stop the robot\n            cmd_msg.linear.x = 0.0\n            cmd_msg.angular.z = 0.0\n\n            # Publish status\n            status_msg = String()\n            status_msg.data = f"Target reached after {time.time() - self.start_time:.1f}s and {self.distance_traveled:.2f}m"\n            self.status_publisher.publish(status_msg)\n\n            # Return to idle after a delay\n            if time.time() - self.start_time > 2.0:\n                self.nav_state = "idle"\n                self.get_logger().info(\'Navigation cycle completed, returning to idle\')\n\n        # Send velocity command\n        self.cmd_vel_publisher.publish(cmd_msg)\n\n        # Log current status\n        status_msg = String()\n        status_msg.data = f"State: {self.nav_state}, Distance: {self.distance_traveled:.2f}m, Obstacle: {self.min_front_distance:.2f}m"\n        self.status_publisher.publish(status_msg)\n\ndef main():\n    rclpy.init()\n    navigator = TurtleBotNavigator()\n\n    try:\n        rclpy.spin(navigator)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        navigator.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == \'__main__\':\n    main()\n'})}),"\n",(0,i.jsx)(n.p,{children:"This comprehensive example demonstrates:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Using multiple message types (Twist, LaserScan, Odometry, String)"}),"\n",(0,i.jsx)(n.li,{children:"Parameter management for configuration"}),"\n",(0,i.jsx)(n.li,{children:"Multiple publishers and subscribers"}),"\n",(0,i.jsx)(n.li,{children:"State management for navigation"}),"\n",(0,i.jsx)(n.li,{children:"Real-time processing of sensor data"}),"\n",(0,i.jsx)(n.li,{children:"Integration of perception (LaserScan) with action (Twist)"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsx)(n.h3,{id:"error-handling-and-logging",children:"Error Handling and Logging"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\n\nclass RobustNode(Node):\n    def __init__(self):\n        super().__init__('robust_node')\n        \n        # Proper error handling\n        try:\n            self.setup_components()\n        except Exception as e:\n            self.get_logger().error(f'Failed to initialize: {str(e)}')\n            raise\n    \n    def setup_components(self):\n        # Setup publishers, subscribers, etc.\n        pass\n"})}),"\n",(0,i.jsx)(n.h3,{id:"resource-management",children:"Resource Management"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"class ResourceManagingNode(Node):\n    def __init__(self):\n        super().__init__('resource_node')\n        self.resources = []\n        \n    def destroy_node(self):\n        # Clean up resources\n        for resource in self.resources:\n            if hasattr(resource, 'cleanup'):\n                resource.cleanup()\n        super().destroy_node()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"interactive-exercises",children:"Interactive Exercises"}),"\n",(0,i.jsx)(n.h3,{id:"exercise-1-time-publisher-and-subscriber",children:"Exercise 1: Time Publisher and Subscriber"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Objective"}),": Create a publisher-subscriber pair that communicates the current time."]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Create a publisher node that publishes the current timestamp to a ",(0,i.jsx)(n.code,{children:"/current_time"})," topic at 1Hz"]}),"\n",(0,i.jsx)(n.li,{children:"Create a subscriber node that listens to this topic and prints the received time"}),"\n",(0,i.jsx)(n.li,{children:"Add a parameter to control the publishing frequency"}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Extension"}),": Have the subscriber calculate and display the time difference between consecutive messages"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Solution Steps"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"# Create a package:\n# ros2 pkg create --build-type ament_python time_publisher_subscriber\n# Add the publisher and subscriber code in separate files\n"})}),"\n",(0,i.jsx)(n.h3,{id:"exercise-2-distance-calculation-service",children:"Exercise 2: Distance Calculation Service"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Objective"}),": Create a service that calculates the distance between two points."]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Create a service server that accepts two coordinate points (x1, y1, x2, y2) and returns the Euclidean distance"}),"\n",(0,i.jsx)(n.li,{children:"Create a client that sends different coordinate pairs to the service"}),"\n",(0,i.jsx)(n.li,{children:"Test the service with multiple coordinate pairs"}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Extension"}),": Add error handling for invalid input values"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Solution Steps"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"# Create a service definition file (in srv folder)\n# Implement the service server and client\n# Use the example_interfaces/srv/AddTwoInts as a template\n"})}),"\n",(0,i.jsx)(n.h3,{id:"exercise-3-configurable-robot-controller",children:"Exercise 3: Configurable Robot Controller"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Objective"}),": Create a node with parameters that control robot behavior."]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Create a node that accepts parameters for robot speed (linear and angular), safety distance, and target distance"}),"\n",(0,i.jsx)(n.li,{children:"Implement a simple navigation behavior that uses these parameters"}),"\n",(0,i.jsx)(n.li,{children:"Test changing parameters at runtime using ros2 param commands"}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Extension"}),": Add validation in the parameter callback to ensure parameters are within safe ranges"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Solution Steps"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"# Use self.declare_parameter() to declare parameters\n# Use self.get_parameter() to access parameter values\n# Add parameter callback to handle runtime updates\n"})}),"\n",(0,i.jsx)(n.h3,{id:"exercise-4-sensor-processing-node",children:"Exercise 4: Sensor Processing Node"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Objective"}),": Create a node that processes sensor data and makes decisions."]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Create a publisher that sends simulated sensor data (e.g., temperature readings)"}),"\n",(0,i.jsx)(n.li,{children:'Create a subscriber that processes this data and makes decisions (e.g., "normal", "warning", "danger")'}),"\n",(0,i.jsx)(n.li,{children:"Publish the decision to another topic"}),"\n",(0,i.jsx)(n.li,{children:"Create a third node that subscribes to the decision topic and logs actions"}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Extension"}),": Add statistical analysis (mean, median, variance) of the sensor readings"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Solution Steps"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"# Use std_msgs for basic data types\n# Implement callbacks to process incoming data\n# Use create_timer() for periodic processing if needed\n"})}),"\n",(0,i.jsx)(n.h3,{id:"exercise-5-multi-node-communication-system",children:"Exercise 5: Multi-Node Communication System"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Objective"}),": Create a system with multiple interconnected nodes."]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Create a sensor node that publishes random sensor readings"}),"\n",(0,i.jsx)(n.li,{children:"Create a filter node that receives sensor data, applies a simple filter, and republishes"}),"\n",(0,i.jsx)(n.li,{children:"Create a monitor node that receives the filtered data and alerts if values exceed thresholds"}),"\n",(0,i.jsx)(n.li,{children:"Create a logger node that records all sensor readings"}),"\n",(0,i.jsx)(n.li,{children:"Use rqt_graph to visualize the node connections"}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Extension"}),": Add services to change threshold values dynamically"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Solution Steps"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"# Each node should focus on a single responsibility\n# Use appropriate message types (or create custom ones)\n# Test with ros2 run and examine node connections with rqt_graph\n"})}),"\n",(0,i.jsx)(n.h3,{id:"exercise-6-parameter-based-behavior-control",children:"Exercise 6: Parameter-Based Behavior Control"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Objective"}),": Create a robot controller that changes behavior based on parameters."]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Create a parameter server node (or use parameters on your main node) with settings for robot behavior modes"}),"\n",(0,i.jsx)(n.li,{children:"Allow switching between different behaviors via parameters (e.g., patrol, follow, avoid)"}),"\n",(0,i.jsx)(n.li,{children:"Demonstrate how parameters can alter the execution without restarting the node"}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Extension"}),": Create an action server that can execute long-running behaviors with feedback"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Solution Steps"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"# Use self.add_on_set_parameters_callback() to handle parameter changes\n# Implement state machine to handle different behaviors\n# Use ros2 param set commands to change behavior at runtime\n"})}),"\n",(0,i.jsx)(n.h3,{id:"exercise-7-system-integration-challenge",children:"Exercise 7: System Integration Challenge"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Objective"}),": Combine multiple concepts into a comprehensive system."]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Create a robot simulation with multiple sensors (e.g., laser range finder, camera simulator)"}),"\n",(0,i.jsx)(n.li,{children:"Implement nodes for each sensor processing"}),"\n",(0,i.jsx)(n.li,{children:"Create a central decision-making node that integrates all sensor data"}),"\n",(0,i.jsx)(n.li,{children:"Add a navigation controller that responds to the decision maker"}),"\n",(0,i.jsx)(n.li,{children:"Use services for high-level commands (start, stop, return to base)"}),"\n",(0,i.jsx)(n.li,{children:"Use parameters to configure the behavior of the entire system"}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Extension"}),": Add a visualization node that displays system state"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Solution Steps"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"# Plan your node architecture before implementing\n# Use appropriate message types for inter-node communication\n# Test components individually before system integration\n# Use rqt tools to monitor system performance\n"})}),"\n",(0,i.jsx)(n.h3,{id:"tools-for-testing-and-verification",children:"Tools for Testing and Verification"}),"\n",(0,i.jsx)(n.p,{children:"To test your exercises, you can use these tools:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ros2 run <package> <node>"})," to run individual nodes"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ros2 topic list"})," and ",(0,i.jsx)(n.code,{children:"ros2 topic echo <topic_name>"})," to examine topics"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ros2 service list"})," and ",(0,i.jsx)(n.code,{children:"ros2 service call <service_name> <type> '{request: ...}'"})," to test services"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"rqt_graph"})," to visualize the node graph"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ros2 param list"})," and ",(0,i.jsx)(n.code,{children:"ros2 param get <node_name> <param_name>"})," to check parameters"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ros2 launch <package> <launch_file>"})," to run multiple nodes together"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"hands-on-package-creation-exercises",children:"Hands-on Package Creation Exercises"}),"\n",(0,i.jsx)(n.h3,{id:"exercise-a-creating-your-first-ros-2-package",children:"Exercise A: Creating Your First ROS 2 Package"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Initialize a Workspace"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"mkdir -p ~/ros2_workspace/src\ncd ~/ros2_workspace/src\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Create the Package"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 pkg create --build-type ament_python first_robot_package\ncd first_robot_package\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"File Structure Created"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"first_robot_package/\n\u251c\u2500\u2500 first_robot_package/\n\u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u2514\u2500\u2500 simple_publisher.py  # We'll create this\n\u251c\u2500\u2500 package.xml\n\u251c\u2500\u2500 setup.cfg\n\u251c\u2500\u2500 setup.py\n\u2514\u2500\u2500 test/\n    \u251c\u2500\u2500 __init__.py\n    \u251c\u2500\u2500 test_copyright.py\n    \u251c\u2500\u2500 test_flake8.py\n    \u2514\u2500\u2500 test_pep257.py\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Create a Simple Publisher Node"}),"\nCreate ",(0,i.jsx)(n.code,{children:"first_robot_package/simple_publisher.py"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass SimplePublisher(Node):\n    def __init__(self):\n        super().__init__('simple_publisher')\n        self.publisher = self.create_publisher(String, 'chatter', 10)\n        timer_period = 0.5  # seconds\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n        self.i = 0\n\n    def timer_callback(self):\n        msg = String()\n        msg.data = f'Hello World: {self.i}'\n        self.publisher.publish(msg)\n        self.get_logger().info(f'Publishing: \"{msg.data}\"')\n        self.i += 1\n\ndef main():\n    rclpy.init()\n    node = SimplePublisher()\n\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Set Execute Permissions"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"chmod +x first_robot_package/simple_publisher.py\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Modify setup.py"}),"\nAdd the following to the setup() call in setup.py:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"entry_points={\n    'console_scripts': [\n        'simple_publisher = first_robot_package.simple_publisher:main',\n    ],\n},\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Build the Package"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_workspace\ncolcon build --packages-select first_robot_package\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Source the Workspace"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"source install/setup.bash\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Run the Node"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 run first_robot_package simple_publisher\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"exercise-b-creating-a-publisher-subscriber-package",children:"Exercise B: Creating a Publisher-Subscriber Package"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Create a New Package"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_workspace/src\nros2 pkg create --build-type ament_python comm_package\ncd comm_package\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Create Publisher Node"}),"\nCreate ",(0,i.jsx)(n.code,{children:"comm_package/talker.py"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass Talker(Node):\n    def __init__(self):\n        super().__init__('talker')\n        self.publisher = self.create_publisher(String, 'messages', 10)\n        timer_period = 0.5\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n        self.counter = 0\n\n    def timer_callback(self):\n        msg = String()\n        msg.data = f'Hello from talker: {self.counter}'\n        self.publisher.publish(msg)\n        self.get_logger().info(f'Publishing: {msg.data}')\n        self.counter += 1\n\ndef main():\n    rclpy.init()\n    talker = Talker()\n\n    try:\n        rclpy.spin(talker)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        talker.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Create Subscriber Node"}),"\nCreate ",(0,i.jsx)(n.code,{children:"comm_package/listener.py"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass Listener(Node):\n    def __init__(self):\n        super().__init__('listener')\n        self.subscription = self.create_subscription(\n            String,\n            'messages',\n            self.listener_callback,\n            10)\n        self.subscription  # Prevent unused variable warning\n\n    def listener_callback(self, msg):\n        self.get_logger().info(f'I heard: \"{msg.data}\"')\n\ndef main():\n    rclpy.init()\n    listener = Listener()\n\n    try:\n        rclpy.spin(listener)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        listener.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Update setup.py"}),"\nAdd both nodes to console_scripts in setup.py:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"entry_points={\n    'console_scripts': [\n        'talker = comm_package.talker:main',\n        'listener = comm_package.listener:main',\n    ],\n},\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Build and Run"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_workspace\ncolcon build --packages-select comm_package\nsource install/setup.bash\n\n# Terminal 1:\nros2 run comm_package talker\n\n# Terminal 2:\nros2 run comm_package listener\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"exercise-c-creating-a-service-server-and-client-package",children:"Exercise C: Creating a Service Server and Client Package"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Create Package"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_workspace/src\nros2 pkg create --build-type ament_python service_demo\ncd service_demo\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Create Service Server"}),"\nCreate ",(0,i.jsx)(n.code,{children:"service_demo/add_two_ints_server.py"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\nimport rclpy\nfrom rclpy.node import Node\nfrom example_interfaces.srv import AddTwoInts\n\nclass AddTwoIntsServer(Node):\n    def __init__(self):\n        super().__init__('add_two_ints_server')\n        self.srv = self.create_service(\n            AddTwoInts,\n            'add_two_ints',\n            self.add_two_ints_callback)\n\n    def add_two_ints_callback(self, request, response):\n        response.sum = request.a + request.b\n        self.get_logger().info(f'{request.a} + {request.b} = {response.sum}')\n        return response\n\ndef main():\n    rclpy.init()\n    server = AddTwoIntsServer()\n\n    try:\n        rclpy.spin(server)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        server.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Create Service Client"}),"\nCreate ",(0,i.jsx)(n.code,{children:"service_demo/add_two_ints_client.py"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\nimport sys\nimport rclpy\nfrom rclpy.node import Node\nfrom example_interfaces.srv import AddTwoInts\n\nclass AddTwoIntsClient(Node):\n    def __init__(self):\n        super().__init__('add_two_ints_client')\n        self.cli = self.create_client(AddTwoInts, 'add_two_ints')\n        while not self.cli.wait_for_service(timeout_sec=1.0):\n            self.get_logger().info('Service not available, waiting again...')\n        self.req = AddTwoInts.Request()\n\n    def send_request(self, a, b):\n        self.req.a = a\n        self.req.b = b\n        self.future = self.cli.call_async(self.req)\n        rclpy.spin_until_future_complete(self, self.future)\n        return self.future.result()\n\ndef main():\n    rclpy.init()\n    client = AddTwoIntsClient()\n\n    if len(sys.argv) != 3:\n        print('Usage: ros2 run service_demo add_two_ints_client X Y')\n        return\n\n    a = int(sys.argv[1])\n    b = int(sys.argv[2])\n\n    response = client.send_request(a, b)\n    if response:\n        print(f'Result of {a} + {b} = {response.sum}')\n    else:\n        print('Service call failed')\n\n    client.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Update setup.py"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"entry_points={\n    'console_scripts': [\n        'add_two_ints_server = service_demo.add_two_ints_server:main',\n        'add_two_ints_client = service_demo.add_two_ints_client:main',\n    ],\n},\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Build and Test"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_workspace\ncolcon build --packages-select service_demo\nsource install/setup.bash\n\n# Terminal 1:\nros2 run service_demo add_two_ints_server\n\n# Terminal 2:\nros2 run service_demo add_two_ints_client 2 3\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"exercise-d-using-parameters-in-your-package",children:"Exercise D: Using Parameters in Your Package"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Create Parameter Node"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_workspace/src/comm_package\n# Create comm_package/parameter_node.py\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass ParameterNode(Node):\n    def __init__(self):\n        super().__init__('parameter_node')\n\n        # Declare parameters with default values\n        self.declare_parameter('message_prefix', 'Robot says: ')\n        self.declare_parameter('publish_rate', 1.0)\n        self.declare_parameter('message_count', 10)\n\n        # Get parameter values\n        self.prefix = self.get_parameter('message_prefix').value\n        self.rate = self.get_parameter('publish_rate').value\n        self.count_limit = self.get_parameter('message_count').value\n\n        # Create publisher\n        self.publisher = self.create_publisher(String, 'param_messages', 10)\n\n        # Create timer based on parameter\n        self.timer = self.create_timer(1.0/self.rate, self.timer_callback)\n        self.counter = 0\n\n    def timer_callback(self):\n        if self.counter < self.count_limit:\n            msg = String()\n            msg.data = f'{self.prefix}Message #{self.counter}'\n            self.publisher.publish(msg)\n            self.get_logger().info(f'Published: {msg.data}')\n            self.counter += 1\n        else:\n            self.get_logger().info('Reached message count limit, stopping.')\n            # In a real system, you might want to stop the node here\n\ndef main():\n    rclpy.init()\n    node = ParameterNode()\n\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Update setup.py"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"entry_points={\n    'console_scripts': [\n        'talker = comm_package.talker:main',\n        'listener = comm_package.listener:main',\n        'parameter_node = comm_package.parameter_node:main',\n    ],\n},\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Build and Test with Parameters"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'cd ~/ros2_workspace\ncolcon build --packages-select comm_package\nsource install/setup.bash\n\n# Run with default parameters\nros2 run comm_package parameter_node\n\n# Run with custom parameters\nros2 run comm_package parameter_node --ros-args -p message_prefix:="Custom prefix: " -p publish_rate:=2.0\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"exercise-e-creating-a-launch-file-for-multiple-nodes",children:"Exercise E: Creating a Launch File for Multiple Nodes"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Create Launch Directory"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"mkdir -p ~/ros2_workspace/src/comm_package/launch\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Create Launch File"}),"\nCreate ",(0,i.jsx)(n.code,{children:"~/ros2_workspace/src/comm_package/launch/communication_nodes.launch.py"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"from launch import LaunchDescription\nfrom launch_ros.actions import Node\n\ndef generate_launch_description():\n    return LaunchDescription([\n        Node(\n            package='comm_package',\n            executable='talker',\n            name='talker_node',\n            parameters=[\n                {'publish_rate': 2.0}  # Example parameter override\n            ],\n            output='screen'\n        ),\n        Node(\n            package='comm_package',\n            executable='listener',\n            name='listener_node',\n            output='screen'\n        ),\n        Node(\n            package='comm_package',\n            executable='parameter_node',\n            name='param_node',\n            parameters=[\n                {'message_prefix': 'Launch file: '}\n            ],\n            output='screen'\n        )\n    ])\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Update setup.py to include launch files"}),"\nModify the data_files section in setup.py:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import os\nfrom glob import glob\nfrom setuptools import setup\n\n# ... existing setup code ...\n\nsetup(\n    # ... other setup parameters ...\n    data_files=[\n        ('share/ament_index/resource_index/packages',\n         ['resource/comm_package']),\n        ('share/comm_package',\n         ['package.xml']),\n        # Include launch files\n        (os.path.join('share', 'comm_package', 'launch'),\n         glob(os.path.join('launch', '*launch.[pxy][yma]*'))),\n    ],\n    # ... rest of setup parameters ...\n)\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Build and Run with Launch File"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_workspace\ncolcon build --packages-select comm_package\nsource install/setup.bash\n\nros2 launch comm_package communication_nodes.launch.py\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"exercise-f-creating-custom-message-types",children:"Exercise F: Creating Custom Message Types"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Create Custom Message Package"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_workspace/src\nros2 pkg create --build-type ament_python custom_msgs --dependencies std_msgs builtin_interfaces\ncd custom_msgs\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Create Message Definition"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"mkdir msg\n# Create msg/NumArray.msg\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Content of ",(0,i.jsx)(n.code,{children:"msg/NumArray.msg"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"# Custom message for an array of numbers\nfloat64[] data\nstring description\nbuiltin_interfaces/Time timestamp\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Update package.xml"}),"\nAdd dependencies for message generation:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:"<buildtool_depend>ament_python</buildtool_depend>\n<depend>std_msgs</depend>\n<depend>builtin_interfaces</depend>\n<member_of_group>rosidl_interface_packages</member_of_group>\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Update setup.py"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"from setuptools import setup\nfrom glob import glob\nimport os\n\npackage_name = 'custom_msgs'\n\nsetup(\n    name=package_name,\n    version='0.0.0',\n    packages=[package_name],\n    data_files=[\n        ('share/ament_index/resource_index/packages',\n         ['resource/' + package_name]),\n        ('share/' + package_name, ['package.xml']),\n    ],\n    install_requires=['setuptools'],\n    zip_safe=True,\n    maintainer='Your Name',\n    maintainer_email='your.email@example.com',\n    description='Custom messages for Physical AI textbook',\n    license='MIT',\n    tests_require=['pytest'],\n    entry_points={\n        'console_scripts': [\n        ],\n    },\n    # Add the following for custom messages\n    packages=[package_name],\n    py_modules=[],\n    package_data={},\n    # This is important for message generation\n    data_files=[\n        ('share/ament_index/resource_index/packages',\n         ['resource/' + package_name]),\n        ('share/' + package_name,\n         ['package.xml']),\n        ('share/' + package_name + '/msg',\n         ['msg/NumArray.msg']),\n    ],\n    # Add this to generate messages\n    # The exact configuration would depend on your ROS 2 distribution\n    # In newer versions, you might need to use:\n    # 'rosidl_generate_interfaces': ['custom_msgs'],\n)\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Build and Use Custom Message"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_workspace\ncolcon build --packages-select custom_msgs\nsource install/setup.bash\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"These exercises provide hands-on experience creating complete ROS 2 packages with various node types, parameters, launch files, and custom messages."}),"\n",(0,i.jsx)(n.h2,{id:"troubleshooting-common-ros-2-issues",children:"Troubleshooting Common ROS 2 Issues"}),"\n",(0,i.jsx)(n.h3,{id:"common-issues-and-solutions",children:"Common Issues and Solutions"}),"\n",(0,i.jsx)(n.h4,{id:"1-module-import-errors",children:"1. Module Import Errors"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Problem"}),": ",(0,i.jsx)(n.code,{children:"ModuleNotFoundError: No module named 'rclpy'"}),"\n",(0,i.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Ensure ROS 2 is sourced: ",(0,i.jsx)(n.code,{children:"source /opt/ros/<distro>/setup.bash"})]}),"\n",(0,i.jsx)(n.li,{children:"Install ROS 2 Python packages if missing"}),"\n",(0,i.jsx)(n.li,{children:"Check if you're using the correct Python environment"}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"2-node-connection-issues",children:"2. Node Connection Issues"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Problem"}),": Nodes can't communicate with each other\n",(0,i.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Verify that both nodes use the same RMW (ROS Middleware) implementation"}),"\n",(0,i.jsxs)(n.li,{children:["Check if nodes are on the same ROS domain: ",(0,i.jsx)(n.code,{children:"echo $ROS_DOMAIN_ID"})]}),"\n",(0,i.jsx)(n.li,{children:"Ensure DDS communication is not blocked by firewall"}),"\n",(0,i.jsxs)(n.li,{children:["Use ",(0,i.jsx)(n.code,{children:"ros2 topic list"})," to confirm topics exist"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"3-topicservice-names-conflicts",children:"3. Topic/Service Names Conflicts"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Problem"}),": Nodes not communicating on expected topics/services\n",(0,i.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Use ",(0,i.jsx)(n.code,{children:"ros2 node list"})," and ",(0,i.jsx)(n.code,{children:"ros2 topic list"})," to see active entities"]}),"\n",(0,i.jsx)(n.li,{children:"Check for typos in topic/service names"}),"\n",(0,i.jsx)(n.li,{children:"Verify QoS profiles match between publisher and subscriber"}),"\n",(0,i.jsxs)(n.li,{children:["Use ",(0,i.jsx)(n.code,{children:"ros2 topic info <topic_name>"})," to see endpoint details"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"4-parameter-issues",children:"4. Parameter Issues"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Problem"}),": Parameters not being read or updated at runtime\n",(0,i.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Ensure parameters are declared with ",(0,i.jsx)(n.code,{children:"self.declare_parameter()"})]}),"\n",(0,i.jsxs)(n.li,{children:["Use ",(0,i.jsx)(n.code,{children:"ros2 param list <node_name>"})," to confirm parameters exist"]}),"\n",(0,i.jsx)(n.li,{children:"Check parameter names for typos"}),"\n",(0,i.jsx)(n.li,{children:"Verify parameter callback is properly registered"}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"5-resource-management-problems",children:"5. Resource Management Problems"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Problem"}),": Nodes not shutting down cleanly or resource leaks\n",(0,i.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Always call ",(0,i.jsx)(n.code,{children:"node.destroy_node()"})," and ",(0,i.jsx)(n.code,{children:"rclpy.shutdown()"})," in finally blocks"]}),"\n",(0,i.jsx)(n.li,{children:"Implement proper signal handling for Ctrl+C"}),"\n",(0,i.jsx)(n.li,{children:"Check for circular references that might prevent garbage collection"}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"6-threading-and-concurrency-issues",children:"6. Threading and Concurrency Issues"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Problem"}),": Deadlocks or race conditions in multi-threaded nodes\n",(0,i.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Use MultiThreadedExecutor carefully"}),"\n",(0,i.jsx)(n.li,{children:"Protect shared resources with locks"}),"\n",(0,i.jsx)(n.li,{children:"Avoid blocking operations in callbacks when using SingleThreadedExecutor"}),"\n",(0,i.jsx)(n.li,{children:"Consider using action servers for long-running tasks instead of blocking callbacks"}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"7-performance-issues",children:"7. Performance Issues"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Problem"}),": Nodes running slowly or missing messages\n",(0,i.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Check queue sizes in publisher/subscriber creation"}),"\n",(0,i.jsx)(n.li,{children:"Reduce unnecessary logging in high-frequency callbacks"}),"\n",(0,i.jsxs)(n.li,{children:["Profile node performance with ",(0,i.jsx)(n.code,{children:"ros2 run topic_tools delay <topic>"})]}),"\n",(0,i.jsx)(n.li,{children:"Consider using different QoS profiles (e.g., durability, reliability settings)"}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"8-package-and-build-issues",children:"8. Package and Build Issues"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Problem"}),": Nodes not running after building with colcon\n",(0,i.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Source the install directory: ",(0,i.jsx)(n.code,{children:"source install/setup.bash"})]}),"\n",(0,i.jsx)(n.li,{children:"Ensure console_scripts are properly defined in setup.py"}),"\n",(0,i.jsx)(n.li,{children:"Check executable permissions on Python files"}),"\n",(0,i.jsx)(n.li,{children:"Verify package.xml includes all necessary dependencies"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"debugging-techniques",children:"Debugging Techniques"}),"\n",(0,i.jsx)(n.h4,{id:"1-verbose-logging",children:"1. Verbose Logging"}),"\n",(0,i.jsx)(n.p,{children:"Always include logging to help debug issues:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"self.get_logger().info('Detailed information about current state')\nself.get_logger().warn('Warning about potential issues')\nself.get_logger().error('Error conditions that need addressing')\n"})}),"\n",(0,i.jsx)(n.h4,{id:"2-using-ros-2-command-line-tools",children:"2. Using ROS 2 Command-line Tools"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Monitor nodes\nros2 node list\nros2 node info <node_name>\n\n# Monitor topics\nros2 topic list\nros2 topic echo <topic_name>\nros2 topic info <topic_name>\n\n# Monitor services\nros2 service list\nros2 service type <service_name>\n\n# Monitor parameters\nros2 param list <node_name>\nros2 param get <node_name> <param_name>\n"})}),"\n",(0,i.jsx)(n.h4,{id:"3-runtime-parameter-adjustment",children:"3. Runtime Parameter Adjustment"}),"\n",(0,i.jsx)(n.p,{children:"Test different parameter values during runtime:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Change parameter while node is running\nros2 param set <node_name> <param_name> <value>\n\n# Example:\nros2 param set my_node publish_rate 2.0\n"})}),"\n",(0,i.jsx)(n.h4,{id:"4-visualization-tools",children:"4. Visualization Tools"}),"\n",(0,i.jsx)(n.p,{children:"Use rqt tools for debugging:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Node graph visualization\nrqt_graph\n\n# Message monitoring\nrqt_plot\nrqt_console\nrqt_bag\n"})}),"\n",(0,i.jsx)(n.h3,{id:"best-practices-for-avoiding-common-issues",children:"Best Practices for Avoiding Common Issues"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Always use proper exception handling"}),":"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def main():\n    rclpy.init()\n    node = MyNode()\n\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Validate incoming messages"}),":"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def callback(self, msg):\n    # Check for invalid values\n    if not self.is_valid_message(msg):\n        self.get_logger().error('Received invalid message')\n        return\n    # Process valid message\n    self.process_message(msg)\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Use appropriate QoS profiles"})," for your application:"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"from rclpy.qos import QoSProfile, ReliabilityPolicy, DurabilityPolicy\n\n# For sensor data (frequent updates, can lose some messages)\nqos_profile = QoSProfile(\n    depth=10,\n    reliability=ReliabilityPolicy.BEST_EFFORT,\n)\n\n# For critical commands (must be delivered)\nqos_profile = QoSProfile(\n    depth=1,\n    reliability=ReliabilityPolicy.RELIABLE,\n    durability=DurabilityPolicy.TRANSIENT_LOCAL,\n)\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"4",children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Plan for graceful degradation"})," when optional components fail:"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"class RobustNode(Node):\n    def __init__(self):\n        super().__init__('robust_node')\n        self.vision_available = True\n        self.laser_available = True\n\n        # Try to create optional subscribers\n        try:\n            self.vision_sub = self.create_subscription(...)\n        except Exception as e:\n            self.get_logger().warn(f'Vision not available: {e}')\n            self.vision_available = False\n"})}),"\n",(0,i.jsx)(n.h2,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"rclpy provides the Python interface to ROS 2 functionality"}),"\n",(0,i.jsx)(n.li,{children:"Python nodes inherit from rclpy.node.Node class"}),"\n",(0,i.jsx)(n.li,{children:"Publishers, subscribers, services, and clients are created through node methods"}),"\n",(0,i.jsx)(n.li,{children:"Executors manage concurrency in ROS 2 Python nodes"}),"\n",(0,i.jsx)(n.li,{children:"Parameters provide configuration management"}),"\n",(0,i.jsx)(n.li,{children:"Proper resource management and error handling are important in production systems"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"further-reading",children:"Further Reading"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"ROS 2 Python Developer Guide"}),"\n",(0,i.jsx)(n.li,{children:'"Effective Robotics Programming with ROS" by Anil Mahtani'}),"\n",(0,i.jsx)(n.li,{children:"Python rclpy API documentation"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,i.jsx)(n.p,{children:"Continue to Module 2, Part 2: URDF Format to learn about robot description and modeling."})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>l});var r=s(6540);const i={},a=r.createContext(i);function t(e){const n=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);